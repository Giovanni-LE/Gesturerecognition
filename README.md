# Gesturerecognition

# Landmark-based Hand Gesture Recognition using MediaPipe: Investigating the Accuracy of Depth Estimation

This repository contains the code and resources for a landmark-based hand gesture recognition project using MediaPipe. The main focus of this project was to investigate the accuracy of depth estimation in MediaPipe and utilize it to develop a game for teaching hand gestures to deaf children from 0 to 5.

## Gesture Recognition Model (Training_validation.ipynb)
To accomplish our goal, we leveraged the landmark data generated by the MediaPipe algorithm to train a feed-forward neural network for gesture classification. The model architecture we used is as follows:

![MODEL](https://github.com/Giovanni-LE/Gesturerecognition/blob/main/modello/model_graph.png)

The model consists of three dense layers, with 64 and 32 units respectively, using the ReLU activation function. The input shape is set to (126,), and the output layer employs the softmax activation function to classify the gestures from 0 to 5, including an additional class for "other" gestures. We trained the model using a dataset we created, which consisted of 3,600 frames for each gesture, resulting in a total of 14,400 frames (MP_DATA). We split the dataset into 5% for testing and the remaining for training. The trained model achieved an accuracy of 0.99.

### Loss and Accuracy Plots
![LOSS FUNCTION](https://github.com/Giovanni-LE/Gesturerecognition/blob/main/modello/Loss.png)
![ACCURACY FUNCTION](https://github.com/Giovanni-LE/Gesturerecognition/blob/main/modello/Accuracy.png)

### CONFUSION METRIX FOR TEST SET
![CM TEST](https://github.com/Giovanni-LE/Gesturerecognition/blob/main/modello/Confusion_matrix.png)

## Real-time Gesture Recognition (Testing.ipynb - Gioco_kids.ipynb)
After training and testing the model, we developed a game specifically designed for deaf children. The game's interface (BG.png) consists of two windows: "NUMBER" and "PLAYER." The "NUMBER" window displays images of numbers (gesture_images) that the child needs to replicate in order to progress and view the next image. Adjacent to the "NUMBER" window is the "PLAYER" window, which displays the child's webcam feed. Between the two windows, there is a timer that counts from 0 to 3. Once the timer reaches 3, the program captures the child's gesture to determine if it matches the target gesture. If the gesture is correctly reproduced, the game proceeds to the next image. The child can choose to exit the game by pressing the "Q" key, which will close the program.

### Game Interface

## Depth Estimation Evaluation (depth_v5.ipynb)
In addition to the gesture recognition game, we also aimed to evaluate the accuracy of depth estimation in MediaPipe using an Intel RealSense RGB-D camera. For each gesture (Frame Depth), we calculated the mean absolute errors (in meters) and the standard deviation. We created separate graphs for each gesture, illustrating the average errors and standard deviations.

### Error and Standard Deviation Graphs
![00](https://github.com/Giovanni-LE/Gesturerecognition/blob/main/Risultati%20depth/00.png)
![11](https://github.com/Giovanni-LE/Gesturerecognition/blob/main/Risultati%20depth/11.png)
![22](https://github.com/Giovanni-LE/Gesturerecognition/blob/main/Risultati%20depth/22.png)
![33](https://github.com/Giovanni-LE/Gesturerecognition/blob/main/Risultati%20depth/33.png)
![44](https://github.com/Giovanni-LE/Gesturerecognition/blob/main/Risultati%20depth/44.png)
![55](https://github.com/Giovanni-LE/Gesturerecognition/blob/main/Risultati%20depth/55.png)

To enhance visualization, we represented the errors on a skeletonized hand. The landmarks were visualized using circles with radii equivalent to the mean error for each landmark.

### Hand Images with Mean Errors
![0](https://github.com/Giovanni-LE/Gesturerecognition/blob/main/Risultati%20depth/gesto0.png)
![1](https://github.com/Giovanni-LE/Gesturerecognition/blob/main/Risultati%20depth/gesto1.png)
![2](https://github.com/Giovanni-LE/Gesturerecognition/blob/main/Risultati%20depth/gesto2.png)
![3](https://github.com/Giovanni-LE/Gesturerecognition/blob/main/Risultati%20depth/gesto3.png)
![4](https://github.com/Giovanni-LE/Gesturerecognition/blob/main/Risultati%20depth/gesto4.png)
![5](https://github.com/Giovanni-LE/Gesturerecognition/blob/main/Risultati%20depth/gesto5.png)

## Conclusion
This project successfully explored the accuracy of depth estimation in MediaPipe and utilized it to develop a game for teaching hand gestures to deaf children. The trained neural network achieved a high accuracy of 0.99 in recognizing gestures from 0 to 5, including an "other" class. The real-time game interface provides an interactive and engaging learning experience for children. Additionally, the evaluation of depth estimation through the Intel RealSense camera sheds light on the accuracy of MediaPipe's landmark depth estimation.
